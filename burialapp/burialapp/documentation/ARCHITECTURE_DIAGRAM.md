# Members Module - Architecture Diagram

**Visual guide to understanding the module structure**

---

## ğŸ—ï¸ High-Level Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         MEMBERS.HTML                            â”‚
â”‚  (User Interface Layer)                                         â”‚
â”‚  â€¢ Forms (Member Form, Beneficiary Form)                        â”‚
â”‚  â€¢ Tables (Member List Table)                                   â”‚
â”‚  â€¢ Modals (Edit, Delete, Add Beneficiary)                       â”‚
â”‚  â€¢ Buttons (Add, Edit, Delete, Export)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“ â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         MEMBERS.JS                              â”‚
â”‚  (Main Orchestrator / Controller)                               â”‚
â”‚  â€¢ Manages global state (members array, indexes)                â”‚
â”‚  â€¢ Initializes all modules on page load                         â”‚
â”‚  â€¢ Coordinates between UI, Events, and Services                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“ â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     APPLICATION LAYERS                          â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  EVENT LAYER  â”‚  â”‚   UI LAYER    â”‚  â”‚  SERVICE LAYER   â”‚   â”‚
â”‚  â”‚               â”‚  â”‚               â”‚  â”‚                  â”‚   â”‚
â”‚  â”‚  â€¢ member     â”‚  â”‚  â€¢ memberUI   â”‚  â”‚  â€¢ memberService â”‚   â”‚
â”‚  â”‚    Events.js  â”‚  â”‚    .js        â”‚  â”‚    .js           â”‚   â”‚
â”‚  â”‚               â”‚  â”‚               â”‚  â”‚                  â”‚   â”‚
â”‚  â”‚  â€¢ beneficiaryâ”‚  â”‚  â€¢ beneficiaryâ”‚  â”‚  â€¢ beneficiary   â”‚   â”‚
â”‚  â”‚    Events.js  â”‚  â”‚    UI.js      â”‚  â”‚    Service.js    â”‚   â”‚
â”‚  â”‚               â”‚  â”‚               â”‚  â”‚                  â”‚   â”‚
â”‚  â”‚  Handles user â”‚  â”‚  Renders DOM  â”‚  â”‚  Makes API calls â”‚   â”‚
â”‚  â”‚  interactions â”‚  â”‚  elements     â”‚  â”‚  to backend      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“ â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   SHARED UTILITIES & CONFIG                     â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   HELPERS    â”‚  â”‚   STORAGE    â”‚  â”‚    CONSTANTS       â”‚   â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚                    â”‚   â”‚
â”‚  â”‚  â€¢ showToast â”‚  â”‚  â€¢ save      â”‚  â”‚  â€¢ API_ENDPOINTS   â”‚   â”‚
â”‚  â”‚  â€¢ logDebug  â”‚  â”‚    Members   â”‚  â”‚  â€¢ ERROR_MESSAGES  â”‚   â”‚
â”‚  â”‚  â€¢ validate  â”‚  â”‚  â€¢ get       â”‚  â”‚  â€¢ TOAST_TYPES     â”‚   â”‚
â”‚  â”‚    functions â”‚  â”‚    Members   â”‚  â”‚  â€¢ DEBUG_MODE      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“ â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      CORE SERVICES (SHARED)                     â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚   BASE.JS   â”‚  â”‚   AUTH.JS    â”‚  â”‚  APISERVICE.JS     â”‚    â”‚
â”‚  â”‚             â”‚  â”‚              â”‚  â”‚                    â”‚    â”‚
â”‚  â”‚  â€¢ Base     â”‚  â”‚  â€¢ is        â”‚  â”‚  â€¢ get()           â”‚    â”‚
â”‚  â”‚    HTTP     â”‚  â”‚    Authenti  â”‚  â”‚  â€¢ post()          â”‚    â”‚
â”‚  â”‚    client   â”‚  â”‚    cated()   â”‚  â”‚  â€¢ put()           â”‚    â”‚
â”‚  â”‚             â”‚  â”‚  â€¢ logout()  â”‚  â”‚  â€¢ del()           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“ â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         BACKEND API                             â”‚
â”‚  https://burial.stapps.co.za/api/                               â”‚
â”‚  â€¢ GET /members                                                 â”‚
â”‚  â€¢ POST /members                                                â”‚
â”‚  â€¢ PUT /members/{id}                                            â”‚
â”‚  â€¢ DELETE /members/{id}                                         â”‚
â”‚  â€¢ GET /members/{id}/beneficiaries                              â”‚
â”‚  â€¢ POST /members/{id}/beneficiaries                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Data Flow Diagram

### Example: Adding a New Member

```
    USER ACTION                    EVENT LAYER
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User clicks      â”‚         â”‚ memberEvents.js     â”‚
â”‚ "Add Member"     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ handle              â”‚
â”‚ button           â”‚         â”‚ MemberFormSubmit()  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â”‚ 1. Get form data
                                      â”‚ 2. Validate input
                                      â†“
                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                             â”‚ helpers.js          â”‚
                             â”‚ â€¢ isValidIdNumber() â”‚
                             â”‚ â€¢ isValidPhone()    â”‚
                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â”‚ 3. Call API
                                      â†“
      SERVICE LAYER          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚ memberService.js    â”‚
â”‚ apiService.js       â”‚â—€â”€â”€â”€â”€â”‚ createMember()      â”‚
â”‚ â€¢ post()            â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
         â”‚                           â”‚
         â”‚ 4. HTTP POST              â”‚
         â†“                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚ BACKEND API         â”‚              â”‚
â”‚ POST /members       â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
         â”‚                           â”‚
         â”‚ 5. Response               â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
                                     â”‚ 6. Update global state
                                     â”‚    members.push(result)
                                     â”‚
                                     â”‚ 7. Save to localStorage
                                     â†“
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚ storage.js          â”‚
                            â”‚ saveMembers()       â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â”‚ 8. Update UI
                                     â†“
         UI LAYER           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ memberUI.js         â”‚
â”‚ members.html        â”‚â—€â”€â”€â”€â”‚ renderMembers()     â”‚
â”‚ â€¢ Table updated     â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ â€¢ Form cleared      â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚ 9. Show feedback
                                    â†“
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚ helpers.js          â”‚
                           â”‚ showToast()         â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‚ Module Dependency Tree

Shows which files depend on which:

```
members.html
    â”‚
    â”œâ”€â†’ config/constants.js (no dependencies)
    â”‚
    â”œâ”€â†’ utils/helpers.js
    â”‚   â””â”€â†’ constants.js
    â”‚
    â”œâ”€â†’ utils/storage.js
    â”‚   â””â”€â†’ constants.js
    â”‚
    â”œâ”€â†’ base.js (no dependencies)
    â”‚
    â”œâ”€â†’ auth.js
    â”‚   â”œâ”€â†’ base.js
    â”‚   â””â”€â†’ helpers.js
    â”‚
    â”œâ”€â†’ services/apiService.js
    â”‚   â”œâ”€â†’ base.js
    â”‚   â”œâ”€â†’ auth.js
    â”‚   â””â”€â†’ constants.js
    â”‚
    â”œâ”€â†’ services/memberService.js
    â”‚   â”œâ”€â†’ apiService.js
    â”‚   â”œâ”€â†’ constants.js
    â”‚   â””â”€â†’ helpers.js
    â”‚
    â”œâ”€â†’ services/beneficiaryService.js
    â”‚   â”œâ”€â†’ apiService.js
    â”‚   â”œâ”€â†’ constants.js
    â”‚   â””â”€â†’ helpers.js
    â”‚
    â”œâ”€â†’ modules/memberUI.js
    â”‚   â”œâ”€â†’ helpers.js
    â”‚   â”œâ”€â†’ constants.js
    â”‚   â””â”€â†’ beneficiaryUI.js
    â”‚
    â”œâ”€â†’ modules/beneficiaryUI.js
    â”‚   â”œâ”€â†’ helpers.js
    â”‚   â””â”€â†’ constants.js
    â”‚
    â”œâ”€â†’ modules/memberEvents.js
    â”‚   â”œâ”€â†’ memberService.js
    â”‚   â”œâ”€â†’ memberUI.js
    â”‚   â”œâ”€â†’ storage.js
    â”‚   â”œâ”€â†’ helpers.js
    â”‚   â””â”€â†’ constants.js
    â”‚
    â”œâ”€â†’ modules/beneficiaryEvents.js
    â”‚   â”œâ”€â†’ beneficiaryService.js
    â”‚   â”œâ”€â†’ beneficiaryUI.js
    â”‚   â”œâ”€â†’ memberService.js
    â”‚   â”œâ”€â†’ storage.js
    â”‚   â”œâ”€â†’ helpers.js
    â”‚   â””â”€â†’ constants.js
    â”‚
    â””â”€â†’ members.js (Main Orchestrator)
        â”œâ”€â†’ memberService.js
        â”œâ”€â†’ beneficiaryService.js
        â”œâ”€â†’ memberUI.js
        â”œâ”€â†’ beneficiaryUI.js
        â”œâ”€â†’ memberEvents.js
        â”œâ”€â†’ beneficiaryEvents.js
        â”œâ”€â†’ storage.js
        â”œâ”€â†’ helpers.js
        â””â”€â†’ auth.js
```

**Key Insight:** Files at the top have fewer dependencies. Files at the bottom depend on many others. This is why loading order in HTML matters!

---

## ğŸ¯ Responsibility Matrix

Who does what:

| Module | Responsibilities | Does NOT Handle |
|--------|------------------|----------------|
| **members.js** | â€¢ Initialize app<br>â€¢ Manage global state<br>â€¢ Coordinate modules | â€¢ DOM manipulation<br>â€¢ API calls<br>â€¢ Event handling |
| **memberEvents.js** | â€¢ Handle user clicks<br>â€¢ Form submissions<br>â€¢ Search input | â€¢ Rendering UI<br>â€¢ API logic<br>â€¢ Data storage |
| **memberUI.js** | â€¢ Render member table<br>â€¢ Update DOM<br>â€¢ Format display | â€¢ Handle events<br>â€¢ Make API calls<br>â€¢ Validation |
| **memberService.js** | â€¢ Make API requests<br>â€¢ Handle responses<br>â€¢ Parse data | â€¢ Update UI<br>â€¢ Handle events<br>â€¢ Store locally |
| **helpers.js** | â€¢ Show toasts<br>â€¢ Validate data<br>â€¢ Log messages | â€¢ API calls<br>â€¢ Render UI<br>â€¢ Manage state |
| **storage.js** | â€¢ Save to localStorage<br>â€¢ Load from localStorage | â€¢ Validate data<br>â€¢ Render UI<br>â€¢ API calls |
| **constants.js** | â€¢ Store config values<br>â€¢ Define endpoints | â€¢ Everything else! |

---

## ğŸ”€ State Management Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    GLOBAL STATE                         â”‚
â”‚                    (members.js)                         â”‚
â”‚                                                         â”‚
â”‚  let members = [];          // All member data          â”‚
â”‚  let currentMemberIndex;    // Currently selected       â”‚
â”‚  let editIndex;             // Member being edited      â”‚
â”‚  let deleteIndex;           // Member to delete         â”‚
â”‚  let currentBeneficiaries;  // Beneficiaries list       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“                    â†‘
        READ STATE              UPDATE STATE
                 â†“                    â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ALL MODULES                         â”‚
â”‚  â€¢ memberEvents.js   (reads & updates)                 â”‚
â”‚  â€¢ memberUI.js       (reads only)                      â”‚
â”‚  â€¢ beneficiaryEvents (reads & updates)                 â”‚
â”‚  â€¢ beneficiaryUI.js  (reads only)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
                    STATE CHANGES TRIGGER
                              â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  UI RE-RENDER    â”‚
                    â”‚  renderMembers() â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### State Update Pattern

```javascript
// 1. API Call
const result = await createMember(data);

// 2. Update Global State
members.push(result);

// 3. Persist to LocalStorage
saveMembers(members);

// 4. Update UI
renderMembers();

// 5. User Feedback
showToast('Member added!', 'success');
```

---

## ğŸ”Œ API Integration Points

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FRONTEND                             â”‚
â”‚  memberService.js / beneficiaryService.js               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“ â†‘
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  apiService.js         â”‚
            â”‚  (HTTP Client)         â”‚
            â”‚  â€¢ Adds auth headers   â”‚
            â”‚  â€¢ Handles errors      â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“ â†‘
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  AXIOS Library         â”‚
            â”‚  (HTTP Requests)       â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“ â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    INTERNET                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“ â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            BACKEND API SERVER                           â”‚
â”‚  https://burial.stapps.co.za/api/                       â”‚
â”‚                                                         â”‚
â”‚  ENDPOINTS:                                             â”‚
â”‚  â€¢ GET    /members                  (list)              â”‚
â”‚  â€¢ GET    /members/:id              (detail)            â”‚
â”‚  â€¢ POST   /members                  (create)            â”‚
â”‚  â€¢ PUT    /members/:id              (update)            â”‚
â”‚  â€¢ DELETE /members/:id              (delete)            â”‚
â”‚  â€¢ GET    /members/:id/beneficiaries (list)             â”‚
â”‚  â€¢ POST   /members/:id/beneficiaries (create)           â”‚
â”‚  â€¢ PUT    /beneficiaries/:id         (update)           â”‚
â”‚  â€¢ DELETE /beneficiaries/:id         (delete)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ­ Modal Lifecycle

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MODAL CLOSED                          â”‚
â”‚  (style.display = 'none')                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ User clicks button
                         â”‚ OR
                         â”‚ JavaScript calls showModal()
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MODAL OPENS                           â”‚
â”‚  showModal('modalId')                                    â”‚
â”‚  â€¢ Set display = 'flex'                                  â”‚
â”‚  â€¢ Pre-fill form data (if editing)                       â”‚
â”‚  â€¢ Focus first input                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ Modal is visible
                         â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚            â”‚            â”‚
    User clicks    User presses   User clicks
    "Cancel"        Escape key    outside modal
            â”‚            â”‚            â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   MODAL CLOSES                           â”‚
â”‚  hideModal('modalId')                                    â”‚
â”‚  â€¢ Set display = 'none'                                  â”‚
â”‚  â€¢ Clear form data                                       â”‚
â”‚  â€¢ Reset state variables                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Complete CRUD Flow

### CREATE (Add Member)

```
User fills form â†’ Click Submit
    â†“
handleMemberFormSubmit()
    â†“
Validate input
    â†“
createMember() â†’ POST /members
    â†“
Update members array
    â†“
saveMembers() â†’ localStorage
    â†“
renderMembers() â†’ Update table
    â†“
showToast() â†’ "Success!"
```

### READ (Load Members)

```
Page loads
    â†“
initializeMembersModule()
    â†“
fetchMembers() â†’ GET /members
    â†“
Store in members array
    â†“
saveMembers() â†’ localStorage
    â†“
renderMembers() â†’ Display table
```

### UPDATE (Edit Member)

```
User clicks "Edit"
    â†“
openEditMemberModal(index)
    â†“
Pre-fill form with member[index] data
    â†“
User modifies and saves
    â†“
handleMemberUpdate()
    â†“
Validate input
    â†“
updateMember() â†’ PUT /members/:id
    â†“
Update members[index]
    â†“
saveMembers() â†’ localStorage
    â†“
hideModal() & renderMembers()
    â†“
showToast() â†’ "Updated!"
```

### DELETE (Remove Member)

```
User clicks "Delete"
    â†“
showModal('deleteModal')
    â†“
User confirms
    â†“
handleMemberDelete()
    â†“
deleteMember() â†’ DELETE /members/:id
    â†“
members.splice(index, 1)
    â†“
saveMembers() â†’ localStorage
    â†“
renderMembers()
    â†“
showToast() â†’ "Deleted!"
```

---

## ğŸ“Š Error Handling Flow

```
User Action
    â†“
Event Handler
    â†“
â”Œâ”€â”€â”€ try { â”€â”€â”€â”€â”
â”‚              â”‚
â”‚  Validation  â”‚ â”€â”€â”€ Failed â”€â”€â†’ showToast('error')
â”‚      â”‚       â”‚                      â†“
â”‚   Passed     â”‚                  return/exit
â”‚      â†“       â”‚
â”‚  API Call    â”‚ â”€â”€â”€ Failed â”€â”€â†’ catch block
â”‚      â”‚       â”‚                      â†“
â”‚   Success    â”‚                logError()
â”‚      â†“       â”‚                      â†“
â”‚  Update Stateâ”‚                showToast('error')
â”‚      â†“       â”‚                      â†“
â”‚  Update UI   â”‚                Clean up / rollback
â”‚      â†“       â”‚
â”‚  showToast   â”‚
â”‚  ('success') â”‚
â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Authentication Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              User opens members.html                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â†“
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  Check localStorage    â”‚
            â”‚  for 'authToken'       â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚        â”‚
                    â”‚        â”‚
         Token      â”‚        â”‚      No Token
         Found      â”‚        â”‚
                    â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â†“                     â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Continue loading     â”‚   â”‚  Redirect to     â”‚
    â”‚  members module       â”‚   â”‚  login.html      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â”‚ Each API call includes token
                    â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  apiService.js adds header:           â”‚
    â”‚  Authorization: Bearer <token>        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                     â”‚
    Valid Token          Invalid/Expired
         â”‚                     â”‚
         â†“                     â†“
    API Success      401 Unauthorized
         â”‚                     â”‚
         â†“                     â†“
    Continue         Clear localStorage
                              â†“
                     Redirect to login.html
```

---

## ğŸ“– Related Documents

- [Full Documentation](./MEMBERS_MODULE.md) - Comprehensive guide
- [Quick Reference](./QUICK_REFERENCE.md) - Code snippets and commands
- [CLAUDE.md](../CLAUDE.md) - Project instructions

---

**Last Updated:** December 16, 2025
**Architecture Diagram Version:** 1.0
